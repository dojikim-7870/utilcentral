<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community | UtilCentral</title>
<meta name="description" content="Join the UtilCentral Community. Login with Google, Facebook, Twitter, Microsoft, or Apple to post, comment, and reply to other users.">
<meta name="keywords" content="community, forum, UtilCentral, posts, comments, replies, Firebase, login">
<link rel="canonical" href="https://www.utilcentral.com/community.html">
<link rel="stylesheet" href="style.css">

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-04JWPMYZ7T"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-04JWPMYZ7T');
</script>

<!-- Firebase SDK -->
<script defer src="/__/firebase/12.5.0/firebase-app-compat.js"></script>
<script defer src="/__/firebase/12.5.0/firebase-auth-compat.js"></script>
<script defer src="/__/firebase/12.5.0/firebase-firestore-compat.js"></script>
<script defer src="/__/firebase/init.js"></script>

<style>
body { font-family: 'Roboto', sans-serif; background:#f8f9fa; margin:0; padding:0; color:#333; }
header, footer { background:#fff; box-shadow:0 1px 4px rgba(0,0,0,0.1); padding:10px 20px; }
.logo a { text-decoration:none; font-weight:bold; font-size:1.3em; color:#039be5; }
.main-nav a { margin-right:15px; text-decoration:none; color:#555; font-weight:500; }
.main-nav a.partner-btn { background:#ffa000; color:#fff; padding:5px 10px; border-radius:5px; }
#controls { text-align:center; margin:20px 0; }
#controls h1 { font-size:1.8em; margin-bottom:5px; color:#039be5; }
#controls p { font-size:1em; color:#666; }

.card { background:#fff; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); padding:20px; margin-bottom:15px; }
.post-author { font-weight:bold; color:#039be5; }
.post-timestamp { font-size:0.8em; color:#888; }
textarea { width:100%; border:1px solid #ddd; border-radius:6px; padding:8px; resize:none; }
button { background:#039be5; color:#fff; border:none; border-radius:6px; padding:6px 12px; cursor:pointer; transition:0.2s; }
button:hover { background:#0277bd; }
.comment, .reply { background:#f0f4f8; border-radius:8px; padding:10px; margin-top:8px; }
.reply { margin-left:20px; background:#e3f2fd; }
.comment-author, .reply-author { font-weight:bold; color:#0277bd; }
.comment-timestamp, .reply-timestamp { font-size:0.75em; color:#555; }
.login-btn { margin:5px 5px 10px 0; background:#039be5; }
.login-btn[data-provider="facebook"] { background:#4267B2; }
.login-btn[data-provider="twitter"] { background:#1DA1F2; }
.login-btn[data-provider="microsoft"] { background:#2F2F2F; }
.login-btn[data-provider="apple"] { background:#000; }
#auth-section { text-align:center; margin-bottom:20px; }

@media (max-width:600px){ #controls h1{font-size:1.5em;} button{width:100%; margin-bottom:8px;} .reply{margin-left:10px;} }
</style>
</head>

<body>
<header>
  <div class="logo"><a href="index.html">UtilCentral</a></div>
  <nav class="main-nav" id="main-nav"> 
    <a href="index.html">üõ†Ô∏è Utilities</a>
    <a href="community.html">üí¨ Community</a>
    <a href="request.html">üí° Request/Suggest</a>
    <a href="advertise.html" class="partner-btn">üåü Partner/Advertise</a>
  </nav>
</header>

<div id="controls">
  <h1>Community</h1>
  <p>Login to post, comment, and reply to other users.</p>
</div>

<main>
  <div style="max-width:900px; margin:0 auto; padding:0 15px;">

    <!-- Í≥µÏßÄ -->
    <div class="card" style="border-left:5px solid #ffa000;">
      <h3>Welcome to the UtilCentral Community!</h3>
      <p>Share tips, ask questions, and interact with other users. Keep discussions respectful and relevant to our online tools.</p>
    </div>

    <!-- Î°úÍ∑∏Ïù∏ -->
    <div id="auth-section">
      <button class="login-btn" data-provider="google">Login with Google</button>
      <button class="login-btn" data-provider="facebook">Login with Facebook</button>
      <button class="login-btn" data-provider="twitter">Login with Twitter</button>
      <button class="login-btn" data-provider="microsoft">Login with Microsoft</button>
      <button class="login-btn" data-provider="apple">Login with Apple</button>
      <button id="logout-btn" style="display:none;">Logout</button>
      <p id="user-info"></p>
    </div>

    <!-- Í∏Ä ÏûëÏÑ± -->
    <div id="post-form" class="card" style="display:none;">
      <textarea id="post-content" rows="4" placeholder="Write your post..."></textarea>
      <button id="post-btn">Post</button>
    </div>

    <!-- Í≤åÏãúÍ∏Ä Î¶¨Ïä§Ìä∏ -->
    <div id="posts-container"></div>

  </div>
</main>

<footer>
  <div class="footer-container">
    <div class="footer-section">
      <h4>UtilCentral</h4>
      <p>Your ultimate collection of free, fast, and essential online web utilities. Built for efficiency.</p>
    </div>
    <div class="footer-section">
      <h4>Quick Links</h4>
      <ul>
        <li><a href="https://imagetool.info">ImageTool</a></li>
        <li><a href="https://fixlo.info">Fixlo</a></li>
        <li><a href="https://solvekit.info">Solvekit</a></li>
        <li><a href="https://financetools.info">FinanceTools</a></li>
      </ul>
    </div>
    <div class="footer-section">
      <h4>Legal & Support</h4>
      <ul>
        <li><a href="privacy.html">Privacy Policy</a></li>
        <li><a href="terms.html">Terms of Service</a></li>
        <li><a href="contact.html">Contact Us</a></li>
        <li><a href="about.html">About Us</a></li>
      </ul>
    </div>
    <div class="footer-section">
      <h4>Resources</h4>
      <ul>
        <li><a href="blog.html">Blog & Tutorials</a></li>
        <li><a href="faq.html">FAQ</a></li>
      </ul>
    </div>
  </div>
  <div class="footer-bottom">
    <p>&copy; 2025 UtilCentral. All Rights Reserved.</p>
  </div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, FacebookAuthProvider, TwitterAuthProvider, OAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp, doc, updateDoc } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

// Firebase Ï¥àÍ∏∞Ìôî
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT",
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Providers
const providers = {
  google: new GoogleAuthProvider(),
  facebook: new FacebookAuthProvider(),
  twitter: new TwitterAuthProvider(),
  microsoft: new OAuthProvider('microsoft.com'),
  apple: new OAuthProvider('apple.com')
};

// ÏöîÏÜå
const loginBtns = document.querySelectorAll('.login-btn');
const logoutBtn = document.getElementById('logout-btn');
const userInfo = document.getElementById('user-info');
const postForm = document.getElementById('post-form');
const postContent = document.getElementById('post-content');
const postBtn = document.getElementById('post-btn');
const postsContainer = document.getElementById('posts-container');

// Î°úÍ∑∏Ïù∏
loginBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    const providerName = btn.getAttribute('data-provider');
    const provider = providers[providerName];
    signInWithPopup(auth, provider).catch(console.error);
  });
});
logoutBtn.addEventListener('click', () => signOut(auth));

// Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú Í∞êÏßÄ
onAuthStateChanged(auth, user => {
  if(user){
    loginBtns.forEach(b => b.style.display='none');
    logoutBtn.style.display='inline-block';
    userInfo.textContent = `Hello, ${user.displayName}`;
    postForm.style.display='block';
  } else {
    loginBtns.forEach(b => b.style.display='inline-block');
    logoutBtn.style.display='none';
    userInfo.textContent = '';
    postForm.style.display='none';
  }
});

// Í∏Ä ÏûëÏÑ±
postBtn.addEventListener('click', async ()=>{
  const content = postContent.value.trim();
  if(!content) return alert("Write something!");
  const user = auth.currentUser;
  if(!user) return alert("Login first!");
  await addDoc(collection(db,"posts"),{
    author:user.displayName,
    content:content,
    timestamp:serverTimestamp(),
    comments:[]
  });
  postContent.value='';
});

// Í∏Ä Ïã§ÏãúÍ∞Ñ ÌëúÏãú
const q = query(collection(db,"posts"), orderBy("timestamp","desc"));
onSnapshot(q,snapshot=>{
  postsContainer.innerHTML='';
  snapshot.forEach(docSnap=>{
    const data = docSnap.data();
    const postEl = document.createElement('div');
    postEl.className='card post';

    postEl.innerHTML = `
      <div class="post-author">${data.author}</div>
      <div class="post-timestamp">${data.timestamp?.toDate? data.timestamp.toDate().toLocaleString() : ''}</div>
      <p>${data.content}</p>
      <div class="comments"></div>
      <textarea class="comment-input" rows="2" placeholder="Write a comment..."></textarea>
      <button class="comment-btn">Comment</button>
    `;
    postsContainer.appendChild(postEl);

    const commentsDiv = postEl.querySelector('.comments');

    (data.comments || []).forEach(c=>{
      const cEl = document.createElement('div');
      cEl.className='comment';
      cEl.innerHTML = `<div class="comment-author">${c.author}</div>
                       <div class="comment-timestamp">${c.timestamp?.toDate? c.timestamp.toDate().toLocaleString() : ''}</div>
                       <p>${c.content}</p>
                       <div class="replies"></div>
                       <textarea class="reply-input" rows="1" placeholder="Reply..."></textarea>
                       <button class="reply-btn">Reply</button>`;
      commentsDiv.appendChild(cEl);

      const repliesDiv = cEl.querySelector('.replies');
      (c.replies || []).forEach(r=>{
        const rEl = document.createElement('div');
        rEl.className='reply';
        rEl.innerHTML = `<div class="reply-author">${r.author}</div>
                         <div class="reply-timestamp">${r.timestamp?.toDate? r.timestamp.toDate().toLocaleString() : ''}</div>
                         <p>${r.content}</p>`;
        repliesDiv.appendChild(rEl);
      });

      const replyBtn = cEl.querySelector('.reply-btn');
      const replyInput = cEl.querySelector('.reply-input');
      replyBtn.addEventListener('click', async()=>{
        const replyText = replyInput.value.trim();
        if(!replyText) return alert("Write a reply!");
        const user = auth.currentUser;
        if(!user) return alert("Login first!");
        const postRef = doc(db,"posts",docSnap.id);
        c.replies = c.replies || [];
        c.replies.push({author:user.displayName,content:replyText,timestamp:serverTimestamp()});
        const updatedComments = [...data.comments];
        await updateDoc(postRef,{comments:updatedComments});
        replyInput.value='';
      });
    });

    // ÎåìÍ∏Ä ÏûëÏÑ±
    const commentBtn = postEl.querySelector('.comment-btn');
    const commentInput = postEl.querySelector('.comment-input');
    commentBtn.addEventListener('click', async()=>{
      const commentText = commentInput.value.trim();
      if(!commentText) return alert("Write a comment!");
      const user = auth.currentUser;
      if(!user) return alert("Login first!");
      const postRef = doc(db,"posts",docSnap.id);
      const newComment = {author:user.displayName, content:commentText, timestamp:serverTimestamp(), replies:[]};
      const updatedComments = [...(data.comments||[]), newComment];
      await updateDoc(postRef,{comments:updatedComments});
      commentInput.value='';
    });

  });
});
</script>

</body>
</html>
